<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      /* //동기 => 순차적으로 실행
           //비동기 => 비순차적으로 실행
           console.log(1);
           fetch('hi.txt').then((response) => {
             response.text().then((text) => {
               console.log(text);
             });
           });

           console.log(2); */

      //2nd
      //fetch를 사용하면 promise 객체를 반환 (상태를 가지고 있는 객체)
      // pending = 대기중
      // fullfiled = 성공
      // reject = 실패
      //   console.log(fetch('hi.txt'));

      //   // promise 객체 안에는 then(callback) 함수를 사용할 수 있다.
      //   //callback = call 했을 때 back 받을 약속된 함수
      //   fetch('hi.txt').then(xxx);

      //   // callback 함수
      //   function xxx(response) {
      //     console.log(response);
      //   }

      //3nd
      //fetch('hi.txt').then(console.log);
      //text() 는 body에 있는 데이터를 문자열로 변환하여 promise 객체 타입으로 반환
      //json() 은 body에 있는 데이터를 object로 변환하여 promist 객체 타입으로 반환
      //   fetch('hi.txt').then((response) => {
      //     console.log(response.text()); //promist타입 반환
      //   });

      //   fetch('hi.txt').then((response) => {
      //     //console.log(response.status);
      //     //console.log(response.ok);

      //     if (response.status != 200) {
      //       alert('통신에 실패');
      //       return;
      //     } else {
      //       response.text().then((data) => {
      //         console.log(data);
      //       });
      //     }
      //   });

      /* fetch('hi.txt')
             .then((response) => {
               if (response.status != 200) {
                 console.log('통신 실패');
                 return;
               }

               return response.text(); //이 결과는 fetch 함수의 리턴으로 연결
             })
             .then((data) => {
               console.log(1);
               return data;
             })
             .then((data) => {
               console.log(data);
             })
             .catch((e) => {
               console.log(e); //에러시에 실행됨
             });
      */
      async function test() {
        const response = await fetch('hi.txt');
        //const testdata = await response.json();
        console.log(response.text());
      }

      test();
      //console.log(result);
    </script>
  </body>
</html>
