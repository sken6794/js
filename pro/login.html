<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <!-- 카카오 SDK로드 -->
    <script src="js/kakao.min.js"></script>
    <script src="https://static.nid.naver.com/js/naveridlogin_js_sdk_2.0.2.js"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      .wrap {
        margin: 0 auto;
        border: 1px solid #dadada;
        text-align: center;
        margin-top: 200px;
      }
      .container {
        margin: 20px;
      }
      .container .chulsoo {
        margin-bottom: 30px;
      }
      .arch-text {
        display: block;
        white-space-collapse: collapse;
        text-wrap: nowrap;
      }
      .cls-1 {
        font-size: 117px;
        fill: #ddcbbe;
        font-family: 'IvyMode', sans-serif;
        font-weight: 200;
      }
    </style>
  </head>
  <body>
    <div class="wrap">
      <div class="container">
        <div class="arch-text">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1913.46 1925.18">
            <g id="Layer_2" data-name="Layer 2">
              <g id="Layer_1-2" data-name="Layer 1">
                <text
                  class="cls-1"
                  transform="matrix(0.01, -1, 1, 0.01, 391.44, 1069.66)"
                >
                  T
                </text>
                <text
                  class="cls-1"
                  transform="matrix(0.19, -0.98, 0.98, 0.19, 390.8, 966.29)"
                >
                  h
                </text>
                <text
                  class="cls-1"
                  transform="matrix(0.37, -0.93, 0.93, 0.37, 409.95, 864.66)"
                >
                  e
                </text>
                <text
                  class="cls-1"
                  transform="matrix(0.49, -0.87, 0.87, 0.49, 448.79, 771.96)"
                ></text>
                <text
                  class="cls-1"
                  transform="matrix(0.65, -0.76, 0.76, 0.65, 454.27, 742.28)"
                >
                  W
                </text>
                <text
                  class="cls-1"
                  transform="matrix(0.83, -0.56, 0.56, 0.83, 580.07, 601.86)"
                >
                  h
                </text>
                <text
                  class="cls-1"
                  transform="matrix(0.89, -0.45, 0.45, 0.89, 668.39, 544.33)"
                >
                  i
                </text>
                <text
                  class="cls-1"
                  transform="matrix(0.93, -0.37, 0.37, 0.93, 693.3, 530.35)"
                >
                  t
                </text>
                <text
                  class="cls-1"
                  transform="matrix(0.97, -0.24, 0.24, 0.97, 745.41, 506.57)"
                >
                  e
                </text>
                <text
                  class="cls-1"
                  transform="matrix(0.99, -0.11, 0.11, 0.99, 843.32, 483.92)"
                ></text>
                <text
                  class="cls-1"
                  transform="matrix(1, 0.04, -0.04, 1, 877.61, 475.16)"
                >
                  &amp;
                </text>
                <text
                  class="cls-1"
                  transform="matrix(0.98, 0.2, -0.2, 0.98, 1011.19, 483.87)"
                ></text>
                <text
                  class="cls-1"
                  transform="matrix(0.95, 0.32, -0.32, 0.95, 1046.92, 488.28)"
                >
                  E
                </text>
                <text
                  class="cls-1"
                  transform="matrix(0.88, 0.47, -0.47, 0.88, 1140.98, 519.73)"
                >
                  x
                </text>
                <text
                  class="cls-1"
                  transform="matrix(0.79, 0.62, -0.62, 0.79, 1209.49, 553.52)"
                >
                  o
                </text>
                <text
                  class="cls-1"
                  transform="matrix(0.68, 0.73, -0.73, 0.68, 1292.85, 619.61)"
                >
                  t
                </text>
                <text
                  class="cls-1"
                  transform="matrix(0.62, 0.78, -0.78, 0.62, 1335.9, 665.89)"
                >
                  i
                </text>
                <text
                  class="cls-1"
                  transform="matrix(0.53, 0.85, -0.85, 0.53, 1355.25, 686.17)"
                >
                  c
                </text>
                <text
                  class="cls-1"
                  transform="matrix(0.42, 0.91, -0.91, 0.42, 1404.92, 768.41)"
                ></text>
                <text
                  class="cls-1"
                  transform="matrix(0.27, 0.96, -0.96, 0.27, 1423.9, 798.26)"
                >
                  H
                </text>
                <text
                  class="cls-1"
                  transform="matrix(0.06, 1, -1, 0.06, 1459.45, 921.82)"
                >
                  o
                </text>
                <text
                  class="cls-1"
                  transform="matrix(-0.14, 0.99, -0.99, -0.14, 1466.56, 1031.45)"
                >
                  u
                </text>
                <text
                  class="cls-1"
                  transform="matrix(-0.3, 0.95, -0.95, -0.3, 1451.94, 1134.14)"
                >
                  s
                </text>
                <text
                  class="cls-1"
                  transform="matrix(-0.46, 0.89, -0.89, -0.46, 1430.32, 1208.42)"
                >
                  e
                </text>
              </g>
            </g>
          </svg>
        </div>

        <div class="chulsoo">
          <img src="img/chulsoo.gif" />
        </div>
        <!-- 카카오 로그인 -->
        <div class="kakao-login">
          <a id="kakao-login-btn" href="javascript:loginWithKakao()">
            <img
              src="https://k.kakaocdn.net/14/dn/btroDszwNrM/I6efHub1SN5KCJqLm1Ovx1/o.jpg"
              width="222"
              alt="카카오 로그인 버튼"
            />
          </a>
          <p id="token-result"></p>
          <!-- 네이버 로그인 -->
          <div class="naver-login">
            <!-- 아래와같이 아이디를 꼭 써준다. -->
            <a id="naverIdLogin_loginButton" href="javascript:void(0)">
              <img
                src="img/btnG_완성형.png"
                width="222"
                alt="네이버 로그인 버튼"
              />
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- 카카오 로그인 -->
    <script>
      //1. 카카오 SDK 초기화
      Kakao.init('fdb00cbf1a10006bdc1b4e11edfdc547');
      Kakao.isInitialized();

      //2. 인가서버 창 띄우기
      function loginWithKakao() {
        Kakao.Auth.authorize({
          redirectUri: 'http://127.0.0.1:5500/index.html',
        });
      }

      //카카오 서버에서 인가 코드를 url주소를 담아서 보내줍니다.
      //3. 인가코드 얻기

      var urlSearch = new URLSearchParams(location.search);

      var value = urlSearch.get('code');

      //4. 토큰발급 받기
      if (value != null) {
        ajax();
      }

      function ajax() {
        var url = 'http://127.0.0.1:5500/index.html';
        var key = '2fc89e2b2cc7e6d613cf18b688742adc';

        var data =
          'grant_type=authorization_code' +
          '&client_id=' +
          key +
          '&redirect_uri=' +
          url +
          '&code=' +
          value;

        //토큰 요청
        fetch('https://kauth.kakao.com/oauth/token', {
          method: 'post',
          headers: {
            'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8', //폼형식 (키=값&키=값)
          },
          body: data,
        })
          .then(function (response) {
            return response.json();
          })
          .then(function (data) {
            //브라우저 종료시에 모두 삭제
            //쿠키&세션스토리지에 토큰 값
            sessionStorage.setItem('kakao_access', data.access_token);

            //사용자 정보 API 호출하기
            getUser(data.access_token);
          });
      }

      //5. 토큰기반으로 API호출하기 JS로 처리
      function getUser(token) {
        fetch('https://kapi.kakao.com/v2/user/me', {
          mathod: 'post',
          headers: {
            Authorization: 'Bearer ' + token, //띄어쓰기 무조건 하기
            'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8',
          },
        })
          .then(function (response) {
            return response.json();
          })
          .then(function (data) {
            console.log(data);
          });
      }
    </script>

    <!-- 네이버 로그인 -->

    <script>
      var naverLogin = new naver.LoginWithNaverId({
        clientId: 'uOMFoMjRqSv7m2uAIhIF', //내 애플리케이션 정보에 cliendId를 입력해줍니다.
        callbackUrl: 'http://127.0.0.1:5500/index.html', // 내 애플리케이션 API설정의 Callback URL 을 입력해줍니다.
        isPopup: false,
        callbackHandle: true,
      });

      naverLogin.init();

      window.addEventListener('load', function () {
        naverLogin.getLoginStatus(function (status) {
          if (status) {
            var name = naverLogin.user.getName();
            var mobile = naverLogin.user.getMobile();

            console.log(naverLogin.user);

            if (name == undefined || name == null) {
              alert('이름은 필수정보입니다. 정보제공을 동의해주세요.');
              naverLogin.reprompt();
              return;
            } else if (mobile == undefined || mobile == null) {
              alert('핸드폰 번호는 필수정보입니다. 정보제공을 동의해주세요.');
              naverLogin.reprompt();
              return;
            }
          } else {
            console.log('callback 처리에 실패하였습니다.');
          }
        });
      });

      var testPopUp;
      function openPopUp() {
        testPopUp = window.open(
          'https://nid.naver.com/nidlogin.logout',
          '_blank',
          'toolbar=yes,scrollbars=yes,resizable=yes,width=1,height=1'
        );
      }
      function closePopUp() {
        testPopUp.close();
      }

      function naverLogout() {
        openPopUp();
        setTimeout(function () {
          closePopUp();
        }, 1000);
      }
    </script>
  </body>
</html>
